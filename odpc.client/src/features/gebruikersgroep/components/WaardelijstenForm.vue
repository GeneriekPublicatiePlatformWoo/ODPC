<template>
  <SimpleSpinner v-if="loading" />
  <alert-inline v-else-if="error"
    >Er is iets misgegaan bij het ophalen van de waardelijsten...</alert-inline
  >
  <fieldset v-else>
    <legend>Waardelijsten</legend>

    <checkbox-group
      v-if="organisaties.length"
      :title="WAARDELIJSTEN.ORGANISATIE"
      :options="organisaties"
      v-model="model"
    />

    <checkbox-group
      v-if="informatiecategorieen.length"
      :title="WAARDELIJSTEN.INFORMATIECATEGORIE"
      :options="informatiecategorieen"
      v-model="model"
    />
  </fieldset>
</template>

<script setup lang="ts">
import { computed, useModel } from "vue";
import CheckboxGroup from "@/components/checkbox-group/CheckboxGroup.vue";
import AlertInline from "@/components/AlertInline.vue";
import SimpleSpinner from "@/components/SimpleSpinner.vue";
import { WAARDELIJSTEN, type WaardelijstItem } from "../types";
import { useAllPages } from "@/composables/use-all-pages";
const props = defineProps<{ modelValue: string[] }>();

const model = useModel(props, "modelValue");

const {
  data: organisaties,
  loading: organisatiesLoading,
  error: organisatiesError
} = useAllPages<WaardelijstItem>("/api/v1/organisaties");

const {
  data: informatiecategorieen,
  error: informatiecategorieenError,
  loading: informatiecategorieenLoading
} = useAllPages<WaardelijstItem>("/api/v1/informatiecategorieen");

const error = computed(() => organisatiesError.value || informatiecategorieenError.value);
const loading = computed(() => informatiecategorieenLoading.value || organisatiesLoading.value);
</script>
